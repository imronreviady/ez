(function() {
	
	tinymce.PluginManager.add('mfnsc', function(editor, url) {
		editor.addButton('mfnsc', {
			text : 'Shortcodes',
			type : 'menubutton',
			icon : 'mfn-sc',
			classes: 'widget btn mfnsc',
			menu : [ {
				text : 'Row',
				onclick : function() {
						editor.insertContent('[row]<br><span id="cursorMarker"></span><br>[/row]');
						var placeholderMarker = $(tinyMCE.activeEditor.getBody()).find('#cursorMarker');
						tinyMCE.activeEditor.selection.select(placeholderMarker.get(0) );
						placeholderMarker.remove();
				}				
			}, {
				text : 'Column',
				context:"tools",
				onclick:function(){
					editor.windowManager.open({
						width: 400,
						height: 200,
						resizable: true,
						title:"Add Column",
						body:[
							{	type: 'listbox', 
							    name: 'col_width', 
							    label: 'Width', 
							    'values': [
							        {text: 'One', 		value: '1'},
							        {text: 'Two', 		value: '2'},
							        {text: 'Three', 	value: '3'},
							        {text: 'Four', 		value: '4'},
							        {text: 'Five', 		value: '5'},
							        {text: 'Six', 		value: '6'},
							        {text: 'Seven', 	value: '7'},
							        {text: 'Eight', 	value: '8'},
							        {text: 'Nine', 		value: '9'},
							        {text: 'Ten', 		value: '10'},
							        {text: 'Eleven', 	value: '11'},
							        {text: 'Twelve', 	value: '12'}
							    ]
							},
							{	type: 'listbox', 
							    name: 'col_offset', 
							    label: 'Offset', 
							    'values': [
							        {text: 'No', 		value: '0'},
							        {text: 'One', 		value: '1'},
							        {text: 'Two', 		value: '2'},
							        {text: 'Three', 	value: '3'},
							        {text: 'Four', 		value: '4'},
							        {text: 'Five', 		value: '5'},
							        {text: 'Six', 		value: '6'},
							        {text: 'Seven', 	value: '7'},
							        {text: 'Eight', 	value: '8'},
							        {text: 'Nine', 		value: '9'},
							        {text: 'Ten', 		value: '10'},
							        {text: 'Eleven', 	value: '11'},
							        {text: 'Twelve', 	value: '12'}
							    ]
							},

						],
						onsubmit:function(b){
							editor.insertContent('<div class="' + b.data.col_width + ' ' + b.data.col_offset + '"><br><span id="cursorMarker"></span><div>');
							var placeholderMarker = $(tinyMCE.activeEditor.getBody()).find('#cursorMarker');
							tinyMCE.activeEditor.selection.select(placeholderMarker.get(0) );
							placeholderMarker.remove();
						}
					})
				}				
			}, {
				text : 'Bootstrap',
				menu : [ 
					{
						text : 'Alert',
						context:"tools",
						onclick:function(){
							editor.windowManager.open({
								width: 450,
								height: 300,
								resizable: true,
								title:"Add Alert",
								body:[
									{	type: 'listbox', 
									    name: 'type', 
									    label: 'Alert type', 
									    'values': [
									        {text: 'Success', 	value: 'success'},
									        {text: 'Danger', 	value: 'danger'},
									        {text: 'Info', 		value: 'info'},
									        {text: 'Warning', 	value: 'warning'}
									    ]
									},
									{	type: 'textbox',
										multiline: true, 
									    name: 'content', 
									    label: 'Content'
									},
									{
										type   : 'checkbox',
										name   : 'dismissable',
										label  : 'dismissable',
										text   : 'dismissable',
										checked : true
									}

								],
								onsubmit:function(b){
									if(b.data.dismissable === true) {
										b.data.dismissable = 'dismissable=true ';
									} else {
										b.data.dismissable = '';
									}
									editor.insertContent('[alert type="'+b.data.type+'" '+b.data.dismissable+']'+b.data.content+'[/alert]<br><span id="cursorMarker"></span>');
								var placeholderMarker = $(tinyMCE.activeEditor.getBody()).find('#cursorMarker');
								tinyMCE.activeEditor.selection.select(placeholderMarker.get(0) );
								placeholderMarker.remove();
								}
							})
						}				
					}, {
						text : 'Button',
						context:"tools",
						onclick:function(){
							editor.windowManager.open({
								width: 450,
								height: 450,
								resizable: true,
								title:"Add Button",
								body:[
									{	type: 'listbox', 
									    name: 'type', 
									    label: 'Button type', 
									    'values': [
									        {text: 'Success', 	value: 'success'},
									        {text: 'Danger', 	value: 'danger'},
									        {text: 'Info', 		value: 'info'},
									        {text: 'Warning', 	value: 'warning'}
									    ]
									},
									{	type: 'listbox', 
									    name: 'size', 
									    label: 'Button size',
									    'values': [
									    	{text: 'Small',	value: 'sm'},
									    	{text: 'Medium',	value: ''},
									    	{text: 'Large',	value: 'lg'},
									    	{text: 'Block',	value: 'block'},
									    ]
									},
									{	type: 'textbox',
									    name: 'content', 
									    label: 'Content'
									},
									{	type: 'textbox',
									    name: 'link', 
									    label: 'Link'
									},
									{	type: 'listbox', 
									    name: 'target', 
									    label: 'Target',
									    'values': [
									    	{text: 'Same page',	value: '_self'},
									    	{text: 'New window',	value: '_blank'}
									    ]
									},
									{	type: 'textbox',
									    name: 'classes', 
									    label: 'Custom classes'
									},
									{	type: 'textbox',
									    name: 'title', 
									    label: 'Title'
									},
									{
										type   : 'checkbox',
										name   : 'tooltip',
										label  : 'Tooltip',
										text   : 'tooltip',
										checked : false
									}
								],
								onsubmit:function(b){
									if(b.data.tooltip === true) {
										b.data.tooltip = 'data="toggle,tooltip" ';
									} else {
										b.data.tooltip = '';
									}
									if(b.data.classes === '') { b.data.classes = '';}
									else {b.data.classes = 'xclass="'+b.data.classes+'"';}

									if(b.data.size === '') { b.data.size = '';}
									else {b.data.size = 'size="'+b.data.size+'"';}

									editor.insertContent('[button type="'+b.data.type+'" '+b.data.size+' '+b.data.classes+' link="'+b.data.link+'" title="'+b.data.title+'" target="'+b.data.target+'" '+b.data.tooltip+']'+b.data.content+'[/button]<br><span id="cursorMarker"></span>');
								var placeholderMarker = $(tinyMCE.activeEditor.getBody()).find('#cursorMarker');
								tinyMCE.activeEditor.selection.select(placeholderMarker.get(0) );
								placeholderMarker.remove();
								}
							})
						}
					}, {
						text : 'Button group',
						context:"tools",
						onclick:function(){
							editor.windowManager.open({
								width: 450,
								height: 200,
								resizable: true,
								title:"Add Button group",
								body:[
									{	type: 'listbox', 
									    name: 'size', 
									    label: 'Button size',
									    'values': [
									    	{text: 'Large',		value: 'lg'},
									    	{text: 'Medium',	value: ''},
									    	{text: 'Small',		value: 'sm'},
									    	{text: 'XSmall',	value: 'xs'},
									    ]
									},
									{
										type   : 'checkbox',
										name   : 'vertical',
										label  : 'Vertical',
										checked : false
									},
									{
										type   : 'checkbox',
										name   : 'justified',
										label  : 'Justified',
										checked : false
									}
								],
								onsubmit:function(b){
									if(b.data.vertical === true) {
										b.data.vertical = 'vertical="true" ';
									} else {
										b.data.vertical = '';
									}
									if(b.data.justified === true) {
										b.data.justified = 'justified="true" ';
									} else {
										b.data.justified = '';
									}
									if(b.data.size === '') { b.data.size = '';}
									else {b.data.size = 'size="'+b.data.size+'"';}

									editor.insertContent('[button_group '+b.data.size+' '+b.data.vertical+' '+b.data.justified+'][/button_group]<br><span id="cursorMarker"></span>');
								var placeholderMarker = $(tinyMCE.activeEditor.getBody()).find('#cursorMarker');
								tinyMCE.activeEditor.selection.select(placeholderMarker.get(0) );
								placeholderMarker.remove();
								}
							})
						}
					}, {
						text : 'List group',
						onclick : function() {
								editor.insertContent('[list_group]<br><span id="cursorMarker"></span><br>[/list_group]');
								var placeholderMarker = $(tinyMCE.activeEditor.getBody()).find('#cursorMarker');
								tinyMCE.activeEditor.selection.select(placeholderMarker.get(0) );
								placeholderMarker.remove();
						}				
					}, {
						text : 'List group item',
						onclick : function() {
								editor.insertContent('[list_group_item]<br><span id="cursorMarker"></span><br>[/list_group_item]');
								var placeholderMarker = $(tinyMCE.activeEditor.getBody()).find('#cursorMarker');
								tinyMCE.activeEditor.selection.select(placeholderMarker.get(0) );
								placeholderMarker.remove();
						}				
					}, {
						text : 'Code',
						context:"tools",
						onclick:function(){
							editor.windowManager.open({
								width: 450,
								height: 300,
								resizable: true,
								title:"Add Code",
								body:[
									{
										type   : 'checkbox',
										name   : 'inline',
										label  : 'Inline',
										checked : false
									},
									{
										type   : 'checkbox',
										name   : 'scrollable',
										label  : 'Sscrollable',
										checked : false
									}
								],
								onsubmit:function(b){
									if(b.data.inline === true) {
										b.data.inline = ' inline="true"';
									} else {
										b.data.inline = '';
									}
									if(b.data.scrollable === true) {
										b.data.scrollable = ' scrollable="true"';
									} else {
										b.data.scrollable = '';
									}
									editor.insertContent('[code'+b.data.inline+b.data.scrollable+']<br><span id="cursorMarker"></span><br>[/code]');
								var placeholderMarker = $(tinyMCE.activeEditor.getBody()).find('#cursorMarker');
								tinyMCE.activeEditor.selection.select(placeholderMarker.get(0) );
								placeholderMarker.remove();
								}
							})
						}
					}, {
						text : 'Label',
						context:"tools",
						onclick:function(){
							editor.windowManager.open({
								width: 450,
								height: 200,
								resizable: true,
								title:"Add Label",
								body:[
									{	type: 'textbox',
									    name: 'content',
									    label: 'Content'
									},
									{	type: 'listbox', 
									    name: 'type', 
									    label: 'Label type', 
									    'values': [
									        {text: 'Success', 	value: 'success'},
									        {text: 'Danger', 	value: 'danger'},
									        {text: 'Info', 		value: 'info'},
									        {text: 'Warning', 	value: 'warning'}
									    ]
									}

								],
								onsubmit:function(b){
									editor.insertContent('[label type="'+b.data.type+'"]'+b.data.content+'[/label]<br><span id="cursorMarker"></span>');
								var placeholderMarker = $(tinyMCE.activeEditor.getBody()).find('#cursorMarker');
								tinyMCE.activeEditor.selection.select(placeholderMarker.get(0) );
								placeholderMarker.remove();
								}
							})
						}				
					}, {
						text : 'Badge',
						context:"tools",
						onclick:function(){
							editor.windowManager.open({
								width: 450,
								height: 200,
								resizable: true,
								title:"Add Badge",
								body:[
									{	type: 'textbox',
									    name: 'content',
									    label: 'Content'
									},
									{
										type   : 'checkbox',
										name   : 'right',
										label  : 'Right',
										checked : true
									}

								],
								onsubmit:function(b){
									editor.insertContent('[badge type="'+b.data.right+'"]'+b.data.content+'[/badge]<br><span id="cursorMarker"></span>');
								var placeholderMarker = $(tinyMCE.activeEditor.getBody()).find('#cursorMarker');
								tinyMCE.activeEditor.selection.select(placeholderMarker.get(0) );
								placeholderMarker.remove();
								}
							})
						}				
					}, {
						text : 'Modal',
						context:"tools",
						onclick:function(){
							editor.windowManager.open({
								width: 450,
								height: 300,
								resizable: true,
								title:"Add Modal",
								body:[
									{	type: 'textbox',
									    name: 'text',
									    label: 'Button text'
									},
									{	type: 'textbox',
									    name: 'title',
									    label: 'Modal title'
									},
									{	type: 'textbox',
									    name: 'xclass',
									    label: 'Extra classes'
									},
									{	type: 'textbox',
									    name: 'content',
									    multiline: true,
									    label: 'Content'
									}
								],
								onsubmit:function(b){
									if(b.data.xclass === '') { b.data.xclass = '';}
									else {b.data.xclass = 'xclass="'+b.data.xclass+'"';}
									editor.insertContent('[modal title="'+b.data.title+'" text="'+b.data.text+'" '+b.data.xclass+']<br><span id="cursorMarker"></span><br>[/modal]');
									var placeholderMarker = $(tinyMCE.activeEditor.getBody()).find('#cursorMarker');
									tinyMCE.activeEditor.selection.select(placeholderMarker.get(0) );
									placeholderMarker.remove();
								}
							})
						}				
					}, {
						text : 'Latest posts',
						context:"tools",
						onclick:function(){
							editor.windowManager.open({
								width: 450,
								height: 300,
								resizable: true,
								title:"Latest posts",
								body:[
									{	type: 'textbox',
									    name: 'limit',
									    label: 'Number of posts'
									},
									{	type: 'textbox',
									    name: 'offset',
									    label: 'Offset posts'
									},
									{	type: 'textbox',
									    name: 'category',
									    label: 'Category id'
									}
								],
								onsubmit:function(b){
									if(b.data.limit === '') { b.data.limit = '';}
									else {b.data.limit = 'limit="'+b.data.limit+'"';}
									if(b.data.offset === '') { b.data.offset = '';}
									else {b.data.offset = 'offset="'+b.data.offset+'"';}
									if(b.data.category === '') { b.data.category = '';}
									else {b.data.category = 'category="'+b.data.category+'"';}
									editor.insertContent('[latest_posts '+b.data.limit+' '+b.data.offset+' '+b.data.category+'/]<br><span id="cursorMarker"></span>');
									var placeholderMarker = $(tinyMCE.activeEditor.getBody()).find('#cursorMarker');
									tinyMCE.activeEditor.selection.select(placeholderMarker.get(0) );
									placeholderMarker.remove();
								}
							})
						}				
					}, {
						text : 'Contact form',
						onclick : function() {
								editor.insertContent('[contact_box/]<br><span id="cursorMarker"></span>');
								var placeholderMarker = $(tinyMCE.activeEditor.getBody()).find('#cursorMarker');
								tinyMCE.activeEditor.selection.select(placeholderMarker.get(0) );
								placeholderMarker.remove();
						}				
					}, 
				]
			}, {
				text : 'Theme shortcodes',
				context:"menu",
				menu : [ 
					{
						text : 'Section',
						context:"tools",
						onclick:function(){
							editor.windowManager.open({
								width: 450,
								height: 300,
								resizable: true,
								title:"Add Section",
								body:[
									{	type: 'listbox', 
									    name: 'type', 
									    label: 'Section type', 
									    'values': [
									        {text: 'Empty', value: 'empty'},
									        {text: 'Call to action', value: 'calltoaction'},
									        {text: 'Services', value: 'services'},
									        {text: 'Latest works', value: 'latestworks'},
									        {text: 'Clients', value: 'clients'}
									    ]
									}

								],
								onsubmit:function(b){

									var content = '';
									switch (b.data.type) {
									    case 'calltoaction':
											content = baseUrl + '/feast-content/themes/nova/tinymce/shortcodes/sections/calltoaction.html';								        
									        break;
									    case 'clients':
											content = baseUrl + '/feast-content/themes/nova/tinymce/shortcodes/sections/clients.html';								        
									        break;
									    case 'latestworks':
											content = baseUrl + '/feast-content/themes/nova/tinymce/shortcodes/sections/latestworks.html';								        
									        break;
									    case 'services':
											content = baseUrl + '/feast-content/themes/nova/tinymce/shortcodes/sections/services.html';
									        break;
									    default:
											content = '<section id="about-us" class="container main"><br><span id="cursorMarker"></span></section>';
									}
									if(b.data.type === 'empty') {
										editor.insertContent(content);
									} else {
										$.get(content, function(data) { 
											editor.insertContent(data);
											//alert( "Load was performed." );
										});									
									}
									var placeholderMarker = $(tinyMCE.activeEditor.getBody()).find('#cursorMarker');
									tinyMCE.activeEditor.selection.select(placeholderMarker.get(0) );
									placeholderMarker.remove();
								}
							})
						}				
					}, {
						text : 'Icon box',
						context:"tools",
						onclick:function(){
							editor.windowManager.open({
								width: 450,
								height: 300,
								resizable: true,
								title:"Add Icon box",
								body:[
									{	type: 'textbox',
										multiline: false, 
									    name: 'title', 
									    label: 'Title'
									},
									{	type: 'textbox',
										multiline: true, 
									    name: 'text', 
									    label: 'Text'
									},
									{	type: 'textbox',
										multiline: false, 
									    name: 'icon', 
									    label: 'Icon'
									},
									{	type: 'textbox',
										multiline: false, 
									    name: 'button_text', 
									    label: 'Button Text'
									},
									{	type: 'textbox',
										multiline: false, 
									    name: 'button', 
									    label: 'Button link'
									}

								],
								onsubmit:function(b){
									if(b.data.title === '') { b.data.title = '';} else { b.data.title = 'title="'+b.data.title+'"';}
									if(b.data.text === '') { b.data.text = '';} else { b.data.text = 'text="'+b.data.text+'"';}
									if(b.data.icon === '') { b.data.icon = '';} else { b.data.icon = 'icon="'+b.data.icon+'"';}
									if(b.data.button === '') { b.data.button = '';} else { b.data.button = 'button="'+b.data.button+'"';}
									if(b.data.button_text === '') { b.data.button_text = '';} else { b.data.button_text = 'button_text="'+b.data.button_text+'"';}
									editor.insertContent('[icon_box ' + b.data.title + ' ' + b.data.text + ' ' + b.data.icon + ' ' + b.data.button + ' ' + b.data.button_text + ']<br><span id="cursorMarker"></span>');
								var placeholderMarker = $(tinyMCE.activeEditor.getBody()).find('#cursorMarker');
								tinyMCE.activeEditor.selection.select(placeholderMarker.get(0) );
								placeholderMarker.remove();
								}
							})
						}				
					}, {
						text : 'Slider',
						context:"tools",
						onclick:function(){
							editor.windowManager.open({
								width: 450,
								height: 200,
								resizable: true,
								title:"Add Slider",
								body:[
									{	type: 'textbox',
									    name: 'alias',
									    label: 'Alias'
									},
									{
										type   : 'checkbox',
										name   : 'control',
										label  : 'Control',
										checked : true
									}

								],
								onsubmit:function(b){
									if(b.data.control === true) {
										b.data.control = 'control="'+b.data.control+'"';
									} else {
										b.data.control = '';
									}
									editor.insertContent('[slider alias="'+b.data.alias+'" '+b.data.control+' /]<br><span id="cursorMarker"></span>');
									var placeholderMarker = $(tinyMCE.activeEditor.getBody()).find('#cursorMarker');
									tinyMCE.activeEditor.selection.select(placeholderMarker.get(0) );
									placeholderMarker.remove();
								}
							})
						}				
					}, {
						text : 'Progress bar',
						context:"tools",
						onclick:function(){
							editor.windowManager.open({
								width: 450,
								height: 200,
								resizable: true,
								title:"Add Progress bar",
								body:[
									{	type: 'textbox',
									    name: 'title',
									    label: 'Title'
									},
									{	type: 'textbox',
									    name: 'percent',
									    label: 'Percent'
									},
									{
										type: 'listbox', 
									    name: 'color', 
									    label: 'Color', 
									    'values': [
									        {text: 'Default', value: 'default'},
									        {text: 'Warning', value: 'warning'},
									        {text: 'Danger', value: 'Danger'},
									        {text: 'Info', value: 'info'}
									    ]
									}

								],
								onsubmit:function(b){
									if(b.data.color === 'default') {
										b.data.color = 'progress';
									} else {
										b.data.color = 'progress progress-'+b.data.color;
									}
									editor.insertContent('<div class="'+b.data.color+'"><div class="bar" style="width: '+b.data.percent+'%; text-align:left; padding-left:10px;">'+b.data.title+'</div></div><br><span id="cursorMarker"></span>');
									var placeholderMarker = $(tinyMCE.activeEditor.getBody()).find('#cursorMarker');
									tinyMCE.activeEditor.selection.select(placeholderMarker.get(0) );
									placeholderMarker.remove();
								}
							})
						}				
					}, {
						text : 'Latest posts',
						context:"tools",
						onclick:function(){
							editor.windowManager.open({
								width: 450,
								height: 300,
								resizable: true,
								title:"Latest posts",
								body:[
									{	type: 'textbox',
									    name: 'limit',
									    label: 'Number of posts'
									},
									{	type: 'textbox',
									    name: 'offset',
									    label: 'Offset posts'
									},
									{	type: 'textbox',
									    name: 'category',
									    label: 'Category id'
									}
								],
								onsubmit:function(b){
									if(b.data.limit === '') { b.data.limit = '';}
									else {b.data.limit = 'limit="'+b.data.limit+'"';}
									if(b.data.offset === '') { b.data.offset = '';}
									else {b.data.offset = 'offset="'+b.data.offset+'"';}
									if(b.data.category === '') { b.data.category = '';}
									else {b.data.category = 'category="'+b.data.category+'"';}
									editor.insertContent('[latest_posts '+b.data.limit+' '+b.data.offset+' '+b.data.category+'/]<br><span id="cursorMarker"></span>');
									var placeholderMarker = $(tinyMCE.activeEditor.getBody()).find('#cursorMarker');
									tinyMCE.activeEditor.selection.select(placeholderMarker.get(0) );
									placeholderMarker.remove();
								}
							})
						}				
					}  
				]				
			} ]

		});

	});
	
})();